(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5787],{9778:function(e,s,t){Promise.resolve().then(t.bind(t,2972))},4187:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});/**
 * @license lucide-react v0.356.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(843).Z)("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},9886:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});/**
 * @license lucide-react v0.356.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(843).Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},9580:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});/**
 * @license lucide-react v0.356.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(843).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},8792:function(e,s,t){"use strict";t.d(s,{default:function(){return i.a}});var r=t(5250),i=t.n(r)},2972:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return S}});var r=t(7437),i=t(2265),n=t(6210),a=t(8121),c=t(5671),l=t(575),o=t(9580),d=t(4187),u=t(9886),f=t(843);/**
 * @license lucide-react v0.356.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let m=(0,f.Z)("ShieldQuestion",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),p=(0,f.Z)("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]),h=(0,f.Z)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),g=(0,f.Z)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);var y=t(9724);/**
 * @license lucide-react v0.356.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let x=(0,f.Z)("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);var b=t(8792),v=t(1221),k=t(9069),j=t(6142),N=t(7065),w=t(1776);let C=e=>{let{status:s,message:t}=e;return(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsxs)("div",{className:"w-8 flex-shrink-0",children:["pending"===s&&(0,r.jsx)(o.Z,{className:"h-5 w-5 animate-spin text-muted-foreground"}),"success"===s&&(0,r.jsx)(d.Z,{className:"h-5 w-5 text-green-500"}),"error"===s&&(0,r.jsx)(u.Z,{className:"h-5 w-5 text-destructive"})]}),(0,r.jsx)("p",{className:"font-medium ".concat("error"===s?"text-destructive":""," ").concat("pending"===s?"text-muted-foreground":""),children:t})]})};function S(){let{user:e,isReady:s}=(0,n.useAuth)(),[t,o]=(0,i.useState)({status:"pending",message:"1. Checking for Firebase config variables..."}),[d,u]=(0,i.useState)({status:"pending",message:"2. Checking Firebase App initialization..."}),[f,S]=(0,i.useState)({status:"pending",message:"3. Checking individual Firebase services..."}),[F,Z]=(0,i.useState)({status:"pending",message:"Checking authentication status..."}),[z,A]=(0,i.useState)({status:"pending",message:'Checking public read access for "stalls"...'}),[E,R]=(0,i.useState)({status:"pending",message:'Checking admin read access for "users"...'}),[_,O]=(0,i.useState)({status:"pending",message:"Checking Cloud Functions client initialization..."});return(0,i.useEffect)(()=>{(async()=>{let e,s;if(v.q.apiKey&&v.q.projectId&&"YOUR_KEY_HERE"!==v.q.apiKey)o({status:"success",message:"1. Firebase environment variables are present."});else{o({status:"error",message:"1. Firebase environment variables are missing or are placeholders. Check your .env.local file and ensure all NEXT_PUBLIC_FIREBASE_* keys are set."}),u({status:"error",message:"2. Skipped: Config is missing."}),S({status:"error",message:"3. Skipped: Config is missing."}),A({status:"error",message:"Skipped: Firebase init failed."}),R({status:"error",message:"Skipped: Firebase init failed."}),O({status:"error",message:"Skipped: Firebase init failed."});return}try{if(!(e=(0,j.C6)().length>0?(0,j.Mq)():(0,j.ZF)(v.q)))throw Error("initializeApp returned null or undefined.");u({status:"success",message:"2. Firebase App initialized successfully."})}catch(e){u({status:"error",message:"2. Firebase App initialization failed: ".concat(e.message)}),S({status:"error",message:"3. Skipped: App init failed."}),A({status:"error",message:"Skipped: Firebase init failed."}),R({status:"error",message:"Skipped: Firebase init failed."}),O({status:"error",message:"Skipped: Firebase init failed."});return}try{(0,N.v0)(e),(0,w.$C)(e);let t=(0,v.I)();if(!t||!t.db)throw Error("initializeFirebaseServices returned null or did not contain a db instance.");s=t.db,S({status:"success",message:"3. Auth, Firestore, and Functions services initialized."}),O({status:"success",message:"Cloud Functions client is initialized. Ready to call deployed functions."})}catch(e){S({status:"error",message:"3. Failed to get individual services: ".concat(e.message)}),A({status:"error",message:"Skipped: Service init failed."}),R({status:"error",message:"Skipped: Service init failed."}),O({status:"error",message:"Skipped: Service init failed."});return}try{let e=(0,a.hJ)(s,"stalls");await (0,a.PL)(e),A({status:"success",message:'Successfully connected and read from "stalls" collection (Public Access OK).'})}catch(s){let e='Failed to fetch from "stalls": '.concat(s.message);"permission-denied"===s.code&&(e='Permission Denied. Public access to "stalls" collection is blocked by security rules.'),A({status:"error",message:e})}})()},[]),(0,i.useEffect)(()=>{s&&(e?Z({status:"success",message:"Auth is ready. User is signed in as ".concat(e.email,".")}):Z({status:"success",message:"Auth is ready. No user is currently signed in."}))},[s,e]),(0,i.useEffect)(()=>{(async()=>{let t=(0,v.I)();if(!t){R({status:"error",message:"Admin access check skipped: Firebase services not available."});return}if(!s){R({status:"pending",message:"Waiting for auth to be ready..."});return}if(!e){R({status:"error",message:"Admin access check skipped: No user is signed in."});return}if("admin@u-dry.com"!==e.email){R({status:"success",message:"Test skipped: Signed in as non-admin user (".concat(e.email,"). This is expected.")});return}try{let e=(0,a.hJ)(t.db,"users");await (0,a.PL)(e),R({status:"success",message:'Admin access to "users" collection successful (Security Rules OK).'})}catch(s){let e='Failed to fetch from "users": '.concat(s.message);"permission-denied"===s.code&&(e='Permission Denied. The admin account is blocked by security rules from reading the "users" collection.'),R({status:"error",message:e})}})()},[e,s]),(0,r.jsx)("div",{className:"container mx-auto py-8 px-4 max-w-3xl",children:(0,r.jsxs)(c.Zb,{className:"shadow-xl",children:[(0,r.jsxs)(c.Ol,{children:[(0,r.jsxs)(c.ll,{className:"text-3xl font-bold text-primary flex items-center",children:[(0,r.jsx)(m,{className:"mr-3 h-8 w-8"}),"Application Diagnostic Panel"]}),(0,r.jsx)(c.SZ,{children:"This page performs live checks on critical application systems. Use this to diagnose issues after a crash or before a build."})]}),(0,r.jsxs)(c.aY,{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-4 p-4 border rounded-lg",children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold flex items-center",children:[(0,r.jsx)(p,{className:"mr-2 h-5 w-5"})," Firebase Core"]}),(0,r.jsx)(C,{...t}),(0,r.jsx)(C,{...d}),(0,r.jsx)(C,{...f})]}),(0,r.jsxs)("div",{className:"space-y-4 p-4 border rounded-lg",children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold flex items-center",children:[(0,r.jsx)(h,{className:"mr-2 h-5 w-5"})," Authentication"]}),(0,r.jsx)(C,{...F})]}),(0,r.jsxs)("div",{className:"space-y-4 p-4 border rounded-lg",children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold flex items-center",children:[(0,r.jsx)(g,{className:"mr-2 h-5 w-5"})," Firestore Database"]}),(0,r.jsx)(C,{...z}),(0,r.jsx)(C,{...E}),(0,r.jsxs)(k.bZ,{children:[(0,r.jsx)(y.Z,{className:"h-4 w-4"}),(0,r.jsx)(k.Cd,{children:"Security Rules Note"}),(0,r.jsx)(k.X,{children:"This panel tests for two key permissions: public read access for `stalls` (for the map) and admin-only read access for `users` (for the admin panel). Failures here point directly to misconfigured `firestore.rules`."})]})]}),(0,r.jsxs)("div",{className:"space-y-4 p-4 border rounded-lg",children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold flex items-center",children:[(0,r.jsx)(x,{className:"mr-2 h-5 w-5"})," Cloud Functions"]}),(0,r.jsx)(C,{..._}),(0,r.jsxs)(k.bZ,{children:[(0,r.jsx)(y.Z,{className:"h-4 w-4"}),(0,r.jsx)(k.Cd,{children:"Deployment Note"}),(0,r.jsx)(k.X,{children:"This checks if the client app can connect to the Functions service. It does NOT verify if the functions are successfully deployed. A timeout error during `firebase deploy` points to an issue in `functions/index.js` (often global-scope initializations)."})]})]})]}),(0,r.jsx)(c.eW,{children:(0,r.jsx)(l.z,{asChild:!0,variant:"outline",children:(0,r.jsx)(b.default,{href:"/",children:"Back to Main Page"})})})]})})}},575:function(e,s,t){"use strict";t.d(s,{d:function(){return l},z:function(){return o}});var r=t(7437),i=t(2265),n=t(9143),a=t(9769),c=t(2169);let l=(0,a.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=i.forwardRef((e,s)=>{let{className:t,variant:i,size:a,asChild:o=!1,...d}=e,u=o?n.g7:"button";return(0,r.jsx)(u,{className:(0,c.cn)(l({variant:i,size:a,className:t})),ref:s,...d})});o.displayName="Button"},5671:function(e,s,t){"use strict";t.d(s,{Ol:function(){return c},SZ:function(){return o},Zb:function(){return a},aY:function(){return d},eW:function(){return u},ll:function(){return l}});var r=t(7437),i=t(2265),n=t(2169);let a=i.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...i})});a.displayName="Card";let c=i.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...i})});c.displayName="CardHeader";let l=i.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,r.jsx)("h3",{ref:s,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",t),...i})});l.displayName="CardTitle";let o=i.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,r.jsx)("p",{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",t),...i})});o.displayName="CardDescription";let d=i.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("p-6 pt-0",t),...i})});d.displayName="CardContent";let u=i.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("flex items-center p-6 pt-0",t),...i})});u.displayName="CardFooter"},1266:function(e,s,t){"use strict";t.d(s,{F:function(){return n},e:function(){return a}});var r=t(2265);function i(e,s){if("function"==typeof e)return e(s);null!=e&&(e.current=s)}function n(...e){return s=>{let t=!1,r=e.map(e=>{let r=i(e,s);return t||"function"!=typeof r||(t=!0),r});if(t)return()=>{for(let s=0;s<r.length;s++){let t=r[s];"function"==typeof t?t():i(e[s],null)}}}}function a(...e){return r.useCallback(n(...e),e)}},9143:function(e,s,t){"use strict";t.d(s,{Z8:function(){return a},g7:function(){return c},sA:function(){return o}});var r=t(2265),i=t(1266),n=t(7437);function a(e){let s=function(e){let s=r.forwardRef((e,s)=>{let{children:t,...n}=e;if(r.isValidElement(t)){let e,a;let c=(e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?t.props.ref:t.props.ref||t.ref,l=function(e,s){let t={...s};for(let r in s){let i=e[r],n=s[r];/^on[A-Z]/.test(r)?i&&n?t[r]=(...e)=>{let s=n(...e);return i(...e),s}:i&&(t[r]=i):"style"===r?t[r]={...i,...n}:"className"===r&&(t[r]=[i,n].filter(Boolean).join(" "))}return{...e,...t}}(n,t.props);return t.type!==r.Fragment&&(l.ref=s?(0,i.F)(s,c):c),r.cloneElement(t,l)}return r.Children.count(t)>1?r.Children.only(null):null});return s.displayName=`${e}.SlotClone`,s}(e),t=r.forwardRef((e,t)=>{let{children:i,...a}=e,c=r.Children.toArray(i),l=c.find(d);if(l){let e=l.props.children,i=c.map(s=>s!==l?s:r.Children.count(e)>1?r.Children.only(null):r.isValidElement(e)?e.props.children:null);return(0,n.jsx)(s,{...a,ref:t,children:r.isValidElement(e)?r.cloneElement(e,void 0,i):null})}return(0,n.jsx)(s,{...a,ref:t,children:i})});return t.displayName=`${e}.Slot`,t}var c=a("Slot"),l=Symbol("radix.slottable");function o(e){let s=({children:e})=>(0,n.jsx)(n.Fragment,{children:e});return s.displayName=`${e}.Slottable`,s.__radixId=l,s}function d(e){return r.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===l}}},function(e){e.O(0,[4358,139,7192,5596,5250,7992,6210,2971,8069,1744],function(){return e(e.s=9778)}),_N_E=e.O()}]);